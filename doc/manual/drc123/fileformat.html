<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="en">
  <head>
    <meta content="text/html; charset=ISO-8859-1" http-equiv="content-type">
    <title>DRC123: File format</title>
    <link rel="stylesheet" href="../../common/infstyle.css" type="text/css">
    <meta content="Marcel Müller" name="author">
  </head>
  <body>
    <h2>DRC123 file format</h2>
    <h3>General format</h3>
    <ul>
      <li>DRC123 uses <em>tab separated ASCII files</em> for measurement
        storage.</li>
      <li>Line delimiter is <tt>&lt;CR&gt;&lt;LF&gt;</tt>.</li>
      <li>Column delimiter is <tt>&lt;TAB&gt;</tt>. On input any white
        space delimiter is accepted.</li>
      <li>Lines starting with a single '<tt>#</tt>' are the file
        description.</li>
      <li>Lines starting with '<tt>##</tt>' are measurement parameters. In
        the format <tt>##<var>key</var>=<var>value(s)</var></tt>. The valid
        keys depend on the specific file type.</li>
      <li>Lines starting with '<tt>## </tt>' are informational only. They
        are ignored on read.</li>
      <li>All other non-blank lines are measurement data. The meaning and
        the number of columns depend on the specific file type.</li>
      <li>Columns must contain values, in doubt <tt>nan</tt>.</li>
    </ul>
    <h4>File types</h4>
    <ul>
      <li><a href="#.target">Target files</a></li>
      <li><a href="#.measure">Measurement files</a></li>
      <li><a href="#.calibrate">Sound card calibration files</a></li>
      <li><a href="#.microphone">Microphone calibration files</a></li>
    </ul>
    <h4>Units and conventions</h4>
    <ul>
      <li>All values use SI base units.</li>
      <li><tt>nan</tt> values are ignored. They are taken as if no value
        has been measured at a frequency. This usually causes interpolation to
        be used.</li>
      <li>Differential values like the group delay refer to the interval
        from the frequency of the last line with a not <tt>nan</tt> value to
        the frequency of the current line.<br>
        I.e. if you have a group delay of 0.1 at 20.5 Hz and the last frequency
        was 20.0 Hz then the average group delay in the interval [20.0,20.5] Hz
        is 100 ms.</li>
    </ul>
    <h3><a name=".target"></a>Target files</h3>
    <p><tt>.target</tt> files are used to describe the transformation
      function that should be applied to the played samples before they are
      passed to the amplifier to precompensate for the room response.</p>
    <blockquote>
      <pre>## Generated by DRC123 V1.0<br>##Measurement=D:\TEMP\gcc\drc123\atPC.measure<br>##Measurement=D:\TEMP\gcc\drc123\atPC2.measure<br>##Freq=20.000000,20000.000000<br>##FreqBin=0.250000,0.005000<br>##NormFreq=80.000000,500.000000<br>##LimitGain=3.162278,0.200000<br>##LimitDelay=0.300000,0.050000<br>##InvertHighGain=0<br>##FilterMode=1<br>##DispGain=-20.000000,20.000000<br>##DispDelay=-0.200000,0.200000<br># <br>20	1.33631	-0.3	1.0128	0.01217<br>20.35	1.82673	-0.0807	1.32063	0.15028<br>...</pre>
    </blockquote>
    <h4>Columns</h4>
    <ol>
      <li>Frequency [Hz]</li>
      <li>Gain for channel #1</li>
      <li>Group delay for channel #1 [s]</li>
      <li>Gain for channel #2</li>
      <li>Group delay for channel #2 [s]</li>
    </ol>
    <h4>Parameters</h4>
    <dl>
      <dt><tt>##Measurement</tt></dt>
      <dd><a href="#.measure">Measurement files</a> used to generate this
        target response. This parameter may appear more than once.</dd>
      <dt><tt>##Freq</tt></dt>
      <dd>Frequency range where the target response is defined (domain).</dd>
      <dt><tt>##FreqBin</tt></dt>
      <dd>Width of frequency bins [Hz] and additional relative width.</dd>
      <dt><tt>##NormFreq</tt></dt>
      <dd>Frequency range used for normalization of the target response.</dd>
      <dt><tt>##LimitGain</tt></dt>
      <dd>Maximum gain and maximum gain change rate [1/s].</dd>
      <dt><tt>##LimitDelay</tt></dt>
      <dd>Maximum delay [s] and maximum delay change rate [s/Hz].</dd>
      <dt><tt>##InvertHighGain</tt></dt>
      <dd>Boolean, 1 if gain values above LimitGain should be reduced
        rather than cut at LimitGain. This may prevent DCR123 from driving
        speakers with frequencies that they cannot reproduce.</dd>
      <dt><tt>##FilterMode</tt></dt>
      <dd>Bit vector. 0 = no filter, 1 = subsonic filter, 2 = supersonic
        filter, 3 = both.</dd>
      <dt><tt>##DispGain</tt></dt>
      <dd>Y axis range of the gain graph.</dd>
      <dt><tt>##DispDelay</tt></dt>
      <dd>Y axis range of the group delay graph.</dd>
    </dl>
    <h3><a name=".measure"></a>Measurement files</h3>
    <p><tt>.measure</tt> files are used to store the results of single room
      measurements.</p>
    <blockquote>
      <pre>## Generated by DRC123 V1.0<br>##Mode=0<br>##Channels=0<br>##DiffOut=0<br>##DiffIn=1<br>##CalibrationFile=D:\TEMP\gcc\drc123\Teratec XLerate Pro.calibrate<br>##MicrophoneFile=D:\TEMP\gcc\drc123\wm-60a.microphone<br>##FFTSize=524288<br>##DiscardSamp=524288<br>##AnaSwap=0<br>##LineNotch=3,50.000000<br>##RefFreq=20.000000,20000.000000<br>##RefExponent=-0.200000<br>##RefSkipEven=0<br>##RefSkipRand=0<br>##RefMode=3<br>##RefVolume=1.000000<br>##RefFreqFactor=1.000000<br>##RefEnergyDist=1<br>##DispGain=-40.000000,20.000000<br>##DispDelay=-0.150000,0.300000<br>##DispVU=-40.000000,-12.000000,-6.000000<br>##AverageDelay=0.005521<br>##PhaseUnwrap=218232,18<br># Response of 2.1 system with 18" sub measured in from of the PC<br>19.9584	0.67011	nan	nan	nan<br>20.05	nan	nan	0.71198	nan<br>20.1416	0.61584	-0.0974	nan	nan<br>...</pre>
    </blockquote>
    <h4>Columns</h4>
    <ol>
      <li>Frequency [Hz]</li>
      <li>Gain of channel #1</li>
      <li>Group delay of channel #1 [s]</li>
      <li>Gain of channel #2</li>
      <li>Group delay of channel #2 [s]</li>
    </ol>
    <h4>Parameters</h4>
    <dl>
      <dt><tt>##Mode</tt></dt>
      <dd>Measurement mode. 0 = noise, 1 = sweep.</dd>
      <dt><tt>##Channels</tt></dt>
      <dd>Last measured channel. 0 = stereo, 1 = left, 2 = right.</dd>
      <dt><tt>##DiffOut</tt></dt>
      <dd>Boolean, enable differential output.</dd>
      <dt><tt>##DiffIn</tt></dt>
      <dd>Boolean, use right line in channel as reference.</dd>
      <dt><tt>##CalibrationFile</tt></dt>
      <dd>Used for <a href="#.calibrate">sound card calibration file</a>
        if any.</dd>
      <dt><tt>##MicrophoneFile</tt></dt>
      <dd>Used <a href="#.microphone">mircrophone calibration file</a> if
        any.</dd>
      <dt><tt>##FFTSize</tt></dt>
      <dd>Cycle length of the measurement [samples].</dd>
      <dt><tt>##DiscardSamp</tt></dt>
      <dd>Number of discarded samples at the start of the measurement.</dd>
      <dt><tt>##AnaSwap</tt></dt>
      <dd>Boolean, swap left and right channel on input.</dd>
      <dt><tt>##LineNotch</tt></dt>
      <dd>Line frequency notch. First number = number of harmonics to
        suppress. Second number = line frequency.</dd>
      <dt><tt>##RefFreq</tt></dt>
      <dd>Frequency range with intensity in the reference signal.</dd>
      <dt><tt>##RefExponent</tt></dt>
      <dd>Energy distribution of the reference signal. <i>dP/df ~ f<small><sup>RefExponent</sup></small></i>,
        0 = white noise, -.5 = pink noise, -1 = brown noise.</dd>
      <dt><tt>##RefSkipEven</tt></dt>
      <dd>Boolean, do not use even frequencies.</dd>
      <dt><tt>##RefSkipRand</tt></dt>
      <dd>Boolean, skip some random frequencies in stereo mode to break
        symmetry.</dd>
      <dt><tt>##RefMode</tt></dt>
      <dd>Kind of the reference signal. 0 = mono, 1 = left channel only, 2
        = right channel only, 3 = stereo, 4 = differential. Ignored on input.</dd>
      <dt><tt>##RefVolume</tt></dt>
      <dd>Volume of the reference output [0,1].</dd>
      <dt><tt>##RefFreqFactor</tt></dt>
      <dd>Minimum factor to the next reference frequency.</dd>
      <dt><span style="font-family: monospace;">##RefEnergyDist</span></dt>
      <dd>Distribute energy of unused frequencies to their neighbors.</dd>
      <dt><tt>##DispGain</tt></dt>
      <dd>Y axis range of the gain graph.</dd>
      <dt><tt>##DispDelay</tt></dt>
      <dd>Y axis range of the group delay graph [s].</dd>
      <dt><tt>##DispVU=-40.000000,-12.000000,-6.000000</tt></dt>
      <dd>Range of the VU meter [dB]. First number = start of the green
        bar, second number = start of the yellow bar, third number = start of
        the red bar. The red bar ends at 0 dB FSR.</dd>
      <dt><tt>##AverageDelay</tt></dt>
      <dd>Average group delay of the measurement [s].</dd>
      <dt><tt>##PhaseUnwrap</tt></dt>
      <dd>Number of phase unwraps and number of indeterminate phase unwraps.</dd>
    </dl>
    <h3><a name=".calibrate"></a>Sound card calibration files</h3>
    <p><tt>.calibrate</tt> files store the result from a sound card
      calibration.</p>
    <blockquote>
      <pre>## Generated by DRC123 V1.0<br>##Mode=0<br>##FFTSize=131072<br>##DiscardSamp=65536<br>##AnaSwap=0<br>##RefFreq=10.000000,20000.000000<br>##RefExponent=-0.500000<br>##RefSkipEven=1<br>##RefMode=3<br>##RefVolume=1.000000<br>##RefFreqFactor=1.000000<br>##RefEnergyDist=1<br>##DispGain=-30.000000,10.000000<br>##DispDelay=-360.000000,360.000000<br>##DispVU=-40.000000,-12.000000,-6.000000<br># Terratec XLerate Pro, Aureal Vortex 2 (AU8820) based sound device<br>9.8876	0.4175	nan	nan	nan	0.97078	nan	nan	nan	0.00001	nan	nan	nan<br>10.6201	nan	nan	0.41428	nan	0.97067	0.00003	0.00001	nan	nan	nan	nan	nan<br>11.3525	0.4343	0.01095	nan	nan	0.97054	0.00002	nan	nan	0.00000	0.09924	nan	nan<br>...</pre>
    </blockquote>
    <h4>Columns</h4>
    <ol>
      <li>Frequency [Hz]</li>
      <li>Loopback gain from left output to left input</li>
      <li>Loopback group delay from left output to left input [s]</li>
      <li>Loopback gain from right output to right input</li>
      <li>Loopback group delay from right output to right [s]</li>
      <li>Differential gain between left input and right input</li>
      <li>Differential group delay between left input and right input [s]</li>
      <li>Cross talk gain from right input to left input</li>
      <li>Cross talk group delay from right input to left input [s]</li>
      <li>Cross talk gain from left input to right input</li>
      <li>Cross talk group delay from left input to right input [s]</li>
      <li>Intermodulation amplitude of left channel (optional)</li>
      <li>Intermodulation amplitude of right channel (optional)</li>
    </ol>
    <h4>Parameters</h4>
    <dl>
      <dt><tt>##Mode</tt></dt>
      <dd>Measurement mode. 0 = stereo loopback, 1 = left loopback, 2 =
        right loopback, 3 = differential loopback.<tt> </tt></dd>
      <dt><tt>##FFTSize</tt></dt>
      <dd>Cycle length of the measurement [samples]. </dd>
      <dt><tt>##DiscardSamp</tt></dt>
      <dd>Number of discarded samples at the start of the measurement. </dd>
      <dt><tt>##AnaSwap</tt></dt>
      <dd>Boolean, swap left and right channel on input. </dd>
      <dt><tt>##LineNotch</tt></dt>
      <dd>Line frequency notch. First number = number of harmonics to
        suppress. Second number = line frequency. </dd>
      <dt><tt>##RefFreq</tt></dt>
      <dd>Frequency range with intensity in the reference signal. </dd>
      <dt><tt>##RefExponent</tt></dt>
      <dd>Energy distribution of the reference signal. <i>dP/df ~ f<small><sup>RefExponent</sup></small></i>,
        0 = white noise, -.5 = pink noise, -1 = brown noise. </dd>
      <dt><tt>##RefSkipEven</tt></dt>
      <dd>Boolean, do not use even frequencies. </dd>
      <dt><tt>##RefSkipRand</tt></dt>
      <dd>Boolean, skip some random frequencies in stereo mode to break
        symmetry. </dd>
      <dt><tt>##RefMode</tt></dt>
      <dd>Kind of the reference signal. 0 = mono, 1 = left channel only, 2
        = right channel only, 3 = stereo, 4 = differential. Ignored on input. </dd>
      <dt><tt>##RefVolume</tt></dt>
      <dd>Volume of the reference output [0,1]. </dd>
      <dt><tt>##RefFreqFactor</tt></dt>
      <dd>Minimum factor to the next reference frequency.</dd>
      <dt><span style="font-family: monospace;">##RefEnergyDist</span></dt>
      <dd>Distribute energy of unused frequencies to their neighbors.</dd>
      <dt><tt>##DispGain</tt></dt>
      <dd>Y axis range of the gain graph. </dd>
      <dt><tt>##DispDelay</tt></dt>
      <dd>Y axis range of the group delay graph [°].</dd>
      <dt><tt>##DispVU=-40.000000,-12.000000,-6.000000</tt></dt>
      <dd>Range of the VU meter [dB]. First number = start of the green
        bar, second number = start of the yellow bar, third number = start of
        the red bar. The red bar ends at 0 dB FSR. </dd>
      <dt><tt>##AverageDelay</tt></dt>
      <dd>Average group delay of the measurement [s]. </dd>
      <dt><tt>##PhaseUnwrap</tt></dt>
      <dd>Number of phase unwraps and number of indeterminate phase unwraps.</dd>
    </dl>
    <h3><a name=".microphone"></a>Microphone calibration files</h3>
    <p><tt>.microphone</tt> files are used to compensate for the response
      function of the microphone and the mic amp. DRC123 cannot create
      microphone calibration files. You need this data from third party.</p>
    <blockquote>
      <pre># Panasonic WM-61A electret cardridge, aka Monacor MCE 2000<br># from http://drc-fir.sourceforge.net/<br>20.00000000 1 0<br>1000.000000 1 0.0000174532925<br>2517.141803 1.002015952083772 0.0000173344351<br>...</pre>
    </blockquote>
    <h4>Columns</h4>
    <ol>
      <li>Frequency [Hz]</li>
      <li>Gain</li>
      <li>Group delay [s]</li>
    </ol>
  </body>
</html>
